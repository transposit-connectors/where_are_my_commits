{
  "v2": {
    "transposit": {
      "dependencies": [{
        "name": "transposit/aws_basic:latest",
        "alias": "aws_basic"
      }, {
        "name": "transposit/github:v2.*.*",
        "alias": "github"
      }, {
        "name": "transposit/raw_github:latest",
        "alias": "raw_github"
      }, {
        "name": "transposit/aws_ecs:v3.*.*",
        "alias": "aws_ecs_staging"
      }, {
        "name": "transposit/aws_ecs:v3.*.*",
        "alias": "aws_ecs_prod"
      }, {
        "name": "transposit/aws_ecs:v3.*.*",
        "alias": "aws_ecs_stage"
      }, {
        "name": "transposit/slack:v1.*.*",
        "alias": "slack"
      }, {
        "name": "nina/slack_webhook:latest",
        "alias": "slack_webhook"
      }],
      "operations": [{
        "id": "webhook",
        "function": {
          "parameters": [{
            "name": "http_event",
            "default": {
              "text": "{\"http_method\": \"GET\", \"query_parameters\": {}, \"headers\": {}, \"body\": \"\"}"
            },
            "type": "OBJECT"
          }],
          "js": "webhook.js"
        },
        "access": {
          "requireApiKey": true,
          "webhook": true
        }
      }, {
        "id": "prodDeployEnabled",
        "function": {
          "js": "prodDeployEnabled.js"
        }
      }, {
        "id": "get_commit",
        "tql": {
          "parameters": [{
            "name": "sha",
            "type": "STRING"
          }],
          "tql": "SELECT * FROM github.get_commit\n  WHERE owner='transposit'\n  AND shaCode=@sha\n  AND repo='transposit'\n\n/*\n * For sample code and reference material, visit\n * https://api-composition.transposit.com/get-started/sql-quickstart\n */"
        }
      }, {
        "id": "GetDeployedCommits",
        "function": {
          "js": "untitled.js"
        }
      }, {
        "id": "FindCommit",
        "function": {
          "parameters": [{
            "name": "demoCommit",
            "default": {
              "text": "1662de3735e5963c4bba63f1cba940f686e50c54"
            },
            "type": "STRING"
          }, {
            "name": "stagingCommit",
            "default": {
              "text": "b0097afb560495fc15533a24ff98bce716300529"
            },
            "type": "STRING"
          }, {
            "name": "prodCommit",
            "default": {
              "text": "ed8667cd4ce1f0d7991730be226ef1d17153e3a2"
            },
            "type": "STRING"
          }, {
            "name": "sha",
            "default": {
              "text": "99933565881de573346eb83fe8b0fe8e3a911a53"
            },
            "type": "STRING"
          }],
          "js": "untitled_1.js"
        }
      }, {
        "id": "ListGitCommits",
        "tql": {
          "tql": "select * from raw_github.repos_owner_repo_commits_get \n  WHERE owner='transposit'\n  AND repo='transposit'\n  and per_page = 100\n  -- default sha will be master\n"
        }
      }, {
        "id": "GetCommitMap",
        "function": {
          "js": "GetCommitMap.js"
        }
      }, {
        "id": "MakeSlackMessage",
        "function": {
          "parameters": [{
            "name": "sha",
            "type": "STRING"
          }],
          "js": "webhook_1.js"
        },
        "access": {
          "requireUser": true
        }
      }, {
        "id": "stageNumberMap",
        "function": {
          "js": "stageNumberMap.js"
        }
      }, {
        "id": "list_branches_for_repo",
        "tql": {
          "tql": "SELECT * FROM raw_github.repos_owner_repo_branches_get\n  WHERE owner='transposit'\n  AND repo='transposit'\n  and per_page=100\n  \n/*\n * For sample code and reference material, visit\n * https://docs.transposit.com/get-started/sql-quickstart\n */"
        }
      }, {
        "id": "get_git_tree",
        "tql": {
          "tql": "SELECT * FROM github.get_git_tree\n  WHERE owner='transposit'\n  AND shaCode='2f89bec90c6bb5891c82ad645edecc532cd874d7'\n  AND repo='transposit'\n  \n\n/*\n * For sample code and reference material, visit\n * https://docs.transposit.com/get-started/sql-quickstart\n */"
        }
      }, {
        "id": "HandleSlackResponse",
        "function": {
          "parameters": [{
            "name": "sha",
            "type": "STRING"
          }, {
            "name": "responseUrl",
            "type": "STRING"
          }],
          "js": "untitled_2.js"
        }
      }],
      "dataConnections": [{
        "ref": "aws_basic",
        "overrides": {
          "swagger": {
            "awsConfig": {
              "region": "us-west-2",
              "service": "events"
            },
            "baseUrl": "https://events.us-west-2.amazonaws.com/",
            "executionLimits": {
            }
          }
        }
      }, {
        "ref": "github.raw",
        "requireConsumerSignin": true
      }, {
        "ref": "raw_github",
        "requireConsumerSignin": true
      }],
      "javascriptAPIVersion": "3",
      "source": "src"
    }
  }
}